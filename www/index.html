<!DOCTYPE HTML>
<html>
    <head>
        <title>Road Trip Bonanza</title>
        
        <meta name="viewport" content="width=320" />
        
        <script type="text/javascript" charset="utf-8" src="js/phonegap-1.4.1.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/jquery-1.6.4.min.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/jquery.mobile-1.0.1.min.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/jquery.retina.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/apprise-1.5.min.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/PGLowLatencyAudio.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/rtb.js" type="text/javascript"></script> 
        
        <link href="http://fonts.googleapis.com/css?family=Salsa" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="css/jquery.mobile-1.0.1.min.css" />
        <link rel="stylesheet" href="css/dropdown.css" />
        <link rel="stylesheet" href="css/apprise.min.css" />
        <link rel="stylesheet" type="text/css" href="css/non-retina.css" />
        <link rel="stylesheet" type="text/css" href="css/retina.css" 
        media="only screen and (-webkit-min-device-pixel-ratio: 2)" />
        
        <script type="text/javascript">
            
            function onUnLoaded()
            {
                PGLowLatencyAudio.unload('boop');                
                PGLowLatencyAudio.unload('beep');                
            }
            
            function onBodyLoad()
            {		
                document.addEventListener("deviceready", onDeviceReady, false);
                // document.addEventListener("touchmove", function (e) { e.preventDefault(); return false; }, false);
                // document.addEventListener("touchstart", function (e) { e.preventDefault(); return false; }, false);	
            }
            
            // PhoneGap is ready
            //
            function onDeviceReady() 
            {
                window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, onFileSytemSuccess, onError);
                PGLowLatencyAudio.preloadFX('beep', 'sounds/beepboop.wav');
                PGLowLatencyAudio.preloadFX('boop', 'sounds/boopbeep.wav');                
            }
            
            $(document).ready(function() {
                              $(".dropdown dt a").click(function() {
                                                        $(".dropdown dd ul").toggle();
                                                        });
                              
                              $(".dropdown dd ul li a").click(function() {
                                                              var text = $(this).html();
                                                              $(".dropdown dt a span").html(text);
                                                              $(".dropdown dd ul").hide();
                                                              $("#result").html(getSelectedValue("color-choice"));
                                                              // Show the mic and hide disabled, since we don't have
                                                              // any real events to bind to here...
                                                              // TODO: Create a method that enables/disables the 
                                                              // recording and changes the ontouch events.
                                                              toggleRecordButton('record-disabled record-enabled');                        
                                                            });
                              
                              function getSelectedValue(id) {
                              return $("#" + id).find("dt a span.value").html();
                              }
                              
                              $(document).bind('click', function(e) {
                                               var $clicked = $(e.target);
                                               if (! $clicked.parents().hasClass("dropdown"))
                                               $(".dropdown dd ul").hide();
                                               });
                              
                              // Turn all img to retina display
                              $('img').retina('@2x');
                              loadGames();
                              });
            </script>
    </head>
    <body onload="onBodyLoad()" onunload="onUnLoaded()">
        <!-- Start of home page -->
        <div data-role="page" id="home" data-theme="b">
            
            <div>
                <p>
				<a id="logo" class="btn" data-role="button"></a>
                </p>
            </div>
            <div>
                <p>
				<a class="btn play-btn" href="#categories" data-role="button"></a>
                </p>
            </div>
            <div data-role="footer-btn-bar">
                <div class="left">
                    <a class="float btn labs-btn" href="http://www.moderoblabs.com/" target="_blank" id="labs" data-role="button"></a>
                    <a class="float btn help-btn" href="#help" data-role="button" data-transition="slideup"></a>
                </div>
                <div class="right">
                    <!--<a id="games-btn" class="btn" href="#games" data-role="button"></a>-->
                </div>
            </div>
            <div class="spacer"></div>
            <!-- /content -->
            
        </div>
        <!-- /page -->
        
        <!-- Start of categories page -->
        <div data-role="page" id="categories" data-theme="b">
            <div data-role="content">
                <ul class="none">
                    <li>
                        <a id="road-scout-btn" href="#" class="btn"><img src="images/buttons/road-scout-button.png" width="300px" height="79px"></a>
                    </li>
                    <li>
                        <a id="categories-btn" href="#" class="btn"><img src="images/buttons/categories-button.png" width="300px" height="79px"></a>
                    </li>
                    <li>
                        <a id="act-the-part-btn" href="#" class="btn"><img src="images/buttons/act-the-part-button.png" width="300px" height="79px"></a>
                    </li>
                </ul>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="left">
                    <a class="float btn home-btn" href="#home" data-role="button"></a>
                    <a class="float btn help-btn" href="#help" data-role="button" data-transition="slideup"></a>
                </div>
                <div class="right">
                    
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- /page -->
        
        <!-- Start of enter-name page -->
        <div data-role="page" id="enter-name" data-theme="b">
            <div class="modal">
                <div class="header" id="player-sequence-number">
                    Player 1
                </div>
                <div>
                    <p>Record Your Name</p>
                </div>
                <div style="width: 84%">
                    <div class="left">
                        <!--<div id="bassDiv" ontouchstart="bass()" ontouchend="touchend(event)">Bass</div>-->
                        <div id="record-btn" class="record-disabled btn"></div>
                    </div>
                    <!--<div class="right">
                        <input type="text" size="16" name="name-txt" id="name-txt" title="e.g. Example text" />
                    </div>
                    -->
                    <div id="select-color" class="right">
                        <dl id="color-choice" name="color-choice" class="dropdown">
                            <dt><a href="#"><span>Please select your color</span></a></dt>
                            <dd>
                                <ul>
                                    <li id="blue"><a href="#">Blue<img class="icon" src="images/icons/color-small-blue.png" alt="" /><span class="value">blue</span></a></li>
                                    <li id="green"><a href="#">Green<img class="icon" src="images/icons/color-small-green.png" alt="" /><span class="value">green</span></a></li>
                                    <li id="lightblue"><a href="#">Light Blue<img class="icon" src="images/icons/color-small-lightblue.png" alt="" /><span class="value">lightblue</span></a></li>
                                    <li id="orange"><a href="#">Orange<img class="icon" src="images/icons/color-small-orange.png" alt="" /><span class="value">orange</span></a></li>
                                    <li id="purple"><a href="#">Purple<img class="icon" src="images/icons/color-small-purple.png" alt="" /><span class="value">purple</span></a></li>
                                    <li id="red"><a href="#">Red<img class="icon" src="images/icons/color-small-red.png" alt="" /><span class="value">red</span></a></li>
                                </ul>
                            </dd>
                        </dl>
                        <span id="result"></span>
                        <!--<a data-role="button" href="javascript:playAudio();" ></a>-->
                    </div>                    
                </div>
                <div class="spacer"></div>
                <div class="hr"></div>  
                <div>
                    <div>
                        <p>Current Players</p>
                        <div id="current-players">
                        </div>
                    </div>
                </div>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="left">
                    <a class="float btn back-btn" href="#" data-role="button" data-rel="back"></a>
                    <a class="float btn help-btn" href="#help" id="help" name="help" data-role="button" data-transition="slideup"></a>
                </div>
                <div class="right">
                    <a class="btn next-btn" href="#" id="addPlayer" name="addPlayer" data-role="button"></a>
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- /page -->
        
        <!-- Start of record-name page -->
        <div data-role="page" id="record-name" data-theme="b">
            <div class="modal">
                <div>
                    <h2>Record your name</h2>
                </div>
                <div>
                    <p>
                    <a class="stop-record-btn btn" data-role="button" href="#" data-rel="back"></a>
                    </p>
                </div>
                <div>
                    <p class="caption">Press the microphone to stop recording</p>
                    <h1 id="start-record-message">Get Ready...</h1>
                    <h1 id="go-record"></h1>
                </div>
                <div class="spacer"></div>
            </div>
            <!-- /content -->
        </div>
        <!-- /page -->
        
        <!-- Start of road-scout page -->
        <div data-role="page" id="road-scout" data-theme="b">
            <div data-role="content" class="road-scout">
                <p class="light">
				First person to find a...
                </p>
                <div class="hr"></div>
                <div id="find-name">
                    <h1 id="scout-element"></h1>
                    <div>
                        <a class="btn audio-btn" href="javascript:playAudio();" data-role="button"></a>
                    </div>
                </div>
                <div class="hr"></div>
                <div style="width: 105px;">
                    <a class="foundit-btn" href="#foundit" data-role="button"></a>
                </div>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="left">
                    <a class="btn quit-btn" href="javascript:playAgainReset();" data-role="button"></a>                    
                </div>
                <div class="right">
                    <a class="btn skip-btn" href="javascript:getGameItem();" data-role="button"></a>
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- /page -->
        
        <!-- Start of success-name page -->
        <div data-role="page" id="success-name" data-theme="b">
            <div class="modal">
                <h1>Success!</h1>
                <div class="hr"></div>
                <!--
                 <div id="player-name-txt" class="header">
                 </div>
                 -->
                <div style="width: 75%;">
                    <div>
                        <div class="spacer" height="8px"></div>
                        <div id="color-block" class="left">
                        </div>
                        <div class="right" style="width:60%">
                            <p class="caption">Listen for your name!</p>
                            <p><span id="color-txt"></span></p>
                            <div>
                                <a class="btn audio-btn" href="javascript:playAudio();" data-role="button"></a>
                            </div>
                        </div>
                        <div class="spacer" height="8px"></div>
                    </div>
                </div>
                <div class="hr" style="padding-top:10px;"></div>
                <div style="width:90%">
                    <div class="left">
                        <p>Add Another Player</p>
                    </div>
                    <div class="right">
                        <a class="btn add-player-btn" href="#" id="another-player" data-role="button"></a>
                    </div>
                </div>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="left">
                </div>
                <div class="right">
                    <a class="btn done-btn" href="#" id="play-game" data-role="button"></a>
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- Start of foundit page -->
        <div data-role="page" id="foundit" data-theme="b">
            <div data-role="content" class="road-scout">
                <p class="light">
                First person to find a...
                </p>
                <div class="hr"></div>
                <div>
                    <h1 id="foundit-name"></h1>
                </div>
                <div class="hr"></div>
                <div>
                    <p class="light">Who Found It?</p>
                </div>
                <div class="spacer"></div>
                <div id="select-a-color">
                </div>
                <div class="spacer"></div>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="left">
                    <a class="btn quit-btn" href="javascript:playAgainReset()" data-role="button"></a>                                        
                </div>
                <div class="right">
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- /page -->

        
        <!-- Start of road-scout page -->
        <div data-role="dialog" id="rs-pop-up" data-theme="b" data-direction="reverse">
            <div data-role="content" class="fun-fact">
                <p class="light">
                Did you know?
                </p>
                <div class="hr"></div>
                <p id="fun-fact"></p>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="right">
                    <a class="btn ok-btn" href="#road-scout" id="" data-role="button"></a>
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- /page -->
        <!-- Start of the-end page -->
        <div data-role="page" id="the-end" data-theme="b">
            <div class="modal">
                <h1 class="light">
                    And the Winner is...
                </h1>
                <div class="hr" style="padding-bottom: 10px;"></div>
                <div style="width: 75%">
                    <div id="color-winner" class="left">
                    </div>
                    <!--<div class="right" style="width:64%; overflow: hidden;">
                        <h1 id="winner-name-txt"></h1>
                    </div>
                     -->
                    <div class="spacer"></div>
                </div>
                <div class="spacer"></div>
                <div class="hr" style="padding-top: 10px;"></div>
                <div style="width:90%">
                    <div class="left">
                        <a class="btn play-again-btn" href="javascript:playAgainReset();" data-role="button"></a>
                    </div>
                    <div class="right">
                        <a class="btn home-btn" href="javascript:resetGame();" data-role="button"></a>
                    </div>
                    <div class="spacer"></div>
                </div>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="left">
                </div>
                <div class="right">
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- /page -->      
        <!-- Start of categories-game page -->
        <div data-role="page" id="categories-game" data-theme="b">
            <div data-role="content" class="categories-game">
                <p class="light" id="categories-player-txt">
                PLAYER NAME starts...
                </p>
                <div class="hr"></div>
                <div>
                    <h1 id="categories-game-txt"></h1>
                </div>
                <div class="hr"></div>
                <div style="width: 105px;">
                    <a class="finished-btn" href="#categories-messed-up" data-role="button"></a>
                </div>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="left">
                    <a class="btn quit-btn" href="javascript:playAgainReset();" data-role="button"></a>                                        
                </div>
                <div class="right">
                    <a class="btn skip-btn" href="javascript:getGameItem()" data-role="button"></a>
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- /page -->
        <!-- Start of categories-messed-up page -->
        <div data-role="page" id="categories-messed-up" data-theme="b">
            <div data-role="content" class="categories-game">
                <p class="light" id="categories-player-txt">
                PLAYER NAME starts...
                </p>
                <div class="hr"></div>
                <div>
                    <h1 id="categories-messed-up-txt"></h1>
                </div>
                <div class="hr"></div>
                <div>
                    <p class="light">Who messed up?</p>
                    <div id="messed-up-color">
                        <a href="#"><div class="flag"></div></a>
                    </div>
                    <div class="spacer"></div>
                </div>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="left">
                    <a class="btn quit-btn" href="javascript:playAgainReset();" data-role="button"></a>                                        
                </div>
                <div class="right">
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- /page -->
        <!-- Start of act-the-part page -->
        <div data-role="page" id="act-the-part" data-theme="b">
            <div data-role="content" class="act-the-part">
                <p class="light" id="act-the-part-player-txt">
                PLAYER NAME acts...
                </p>
                <div class="hr"></div>
                <a class="btn tap-btn" id="tap-to-reveal" class="btn" href="javascript:hideReveal()" data-role="button">
                    (tap to reveal)
                </a>
                <div>
                    <h1 id="act-the-part-txt"></h1>
                </div>
                <div class="hr"></div>
                <div style="width: 105px;">
                    <a class="finished-btn" href="#guessed-it" data-role="button"></a>
                </div>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="left">
                    <a class="btn quit-btn" href="javascript:playAgainReset();" data-role="button"></a>                                        
                </div>
                <div class="right">
                    <a class="btn skip-btn" href="javascript:getGameItem()" data-role="button"></a>
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- /page -->
        <!-- Start of guessed-it page -->
        <div data-role="page" id="guessed-it" data-theme="b">
            <div data-role="content" class="act-the-part">
                <p class="light" id="guessed-it-player-txt">
                PLAYER NAME guessed...
                </p>
                <div class="hr"></div>
                <div>
                    <h1 id="guessed-it-txt"></h1>
                </div>
                <div class="hr"></div>
                <div>
                    <p class="light">Who guessed it?</p>
                    <div id="guessed-it-color">
                        <a href="#"><div class="flag"></div></a>
                    </div>
                    <div class="spacer"></div>
                </div>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="left">
                    <a class="btn quit-btn" href="javascript:playAgainReset();" data-role="button"></a>                                        
                </div>
                <div class="right">
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- /page -->
        <!-- Start of help page -->
        <div data-role="page" id="help" data-theme="b">
            <div data-role="content" class="modal">
                <div class="help-bg">
                    <div>
                        <h3>Road Scout:</h3>
                        <p>Scout the road for the items listed within this game. Once someone in the car has found the item, click Found It! Tell the game which person found it so they can be awarded points!
                        </p>
                        
                        <h3>Categories:</h3>
                        <p>Once a category has been given, players will go back and forth with items that would be included in the category. If someone repeats something that has previously been said, they lose. If someone gets stumped and can't think of the next item, they lose.
                        <p>
                        
                        <p><b>Example:</b></p>
                        <ol>
                            <lh>Category: Vegetables</lh>
                            <li>Player 1: Carrots</li>
                            <li>Player 2: Lettuce</li>
                            <li>Player 1: Brussel Sprouts</li>
                            <li>Player 2: Carrots</li>
                            <li>*Player 2 lost because they made a repeat!</li>
                        </ol>
                        
                        <h3>Act The Part:</h3>
                        <p>Players of this game will act the part of the item being shown on the screen. The game will tell you which person is going to act it out, so make sure you hide the device from the other player's view!
                        </p>
                        
                        <p>If the game tells you to act out monkey, you act it out until the other player guesses what you are. You then hand the phone to them so they can act something out for you. If you get stumped, you can always offer hints!
                        </p>
                    </div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
            <!-- /content -->
            <div data-role="footer-btn-bar">
                <div class="left">
                    <a class="float btn home-btn" href="#" data-role="button" data-rel="back"></a>
                </div>
                <div class="right">
                </div>
            </div>
            <div class="spacer"></div>
        </div>
        <!-- /page -->        
    </body>
    
    <script type="text/javascript">
        $("#cat").bind("click", function(event, ui) {
                       getCategoryData();
                       });
        $("#sca").bind("click", function(event, ui) {
                       getScoutData();
                       });
        $("#addPlayer").bind("click", function(event, ui) {
                        stopAudio();
                        //if($('#name-txt').val()==null || $('#name-txt').val()=="")
                        //{
                        //     apprise('Please enter your name!', {'textOk':'Ok'});
                        //}
                        //else
                        
                        // TODO: Add this to a validation method
                        if($(".dropdown dt a span").html() == "Please select your color")
                        {
                             apprise('Please select your color!', {'textOk':'Ok'});
                        }
                        else
                        {
                             addPlayer();
                             $.mobile.changePage( $("#success-name") );
                        }
                });
        $("#record-btn").live("touchstart", function(event, ui) {                              
                              if($(".dropdown dt a span").html() == "Please select your color")
                              {
                              apprise('Please select your color!', {'textOk':'Ok'});
                              }
                              else
                              {
                              recordAudio(); 
                              }
                              });
        $("#road-scout-btn").bind("click", function(event, ui) {
                                  saveSelectedGame("scout");
                                  var playerData = localStorage.getItem("players");
                                  if( playerData == null || playerData == "null")
                                  $.mobile.changePage( $("#enter-name") );
                                  else
                                  getGameItem();
                                  });
        $("#act-the-part-btn").bind("click", function(event, ui) {
                                    saveSelectedGame("act");
                                    var playerData = localStorage.getItem("players");
                                    if( playerData == null || playerData == "null")
                                    $.mobile.changePage( $("#enter-name") );
                                    else
                                    getGameItem();
                                    });
        $("#categories-btn").bind("click", function(event, ui) {
                                  saveSelectedGame("cat");
                                  var playerData = localStorage.getItem("players");
                                  if( playerData == null || playerData == "null")
                                  $.mobile.changePage( $("#enter-name") );
                                  else
                                  getGameItem();
                                  });
        $("#play-game").bind("click", function(event, ui) {
                             getGameItem();                         
                             });        
        $("#another-player").bind("click", function(event, ui) {                            
                                  addAnotherPlayer();
                                  $.mobile.changePage( $("#enter-name") );
                                  });
        $("#fact-ok-button").bind("click", function(event, ui) {                            
                                  getGameItem();
                                  });
        
        $("#success-name").live( "pagehide", function(event){
                                $('#color-txt').toggleClass($('#result').html());
                                $('#color-block').toggleClass($('#result').html());
                                toggleRecordButton('record-disabled record-enabled');                        
        });
        
        $("#rs-pop-up").live( "pageshow", function(event){
                             var parsedGameData = JSON.parse(localStorage.getItem("scout"));
                             var scoutElementList =parsedGameData.scavenge.items;
                             var currentScoutId = localStorage.getItem("currentScoutId");
                             
                             if(currentScoutId == null || currentScoutId == "null")
                             currentScoutId = "1";
                             
                             for (var i = 0; i < scoutElementList.length; i++) 
                             {
                             if( currentScoutId == scoutElementList[i].id)
                             {
                             //set the next id for the next item to find.
                             var nextItem = scoutElementList[i].id;
                             nextItem = Number(nextItem) +1;
                             localStorage.setItem("currentScoutId", nextItem);
                             $('#scout-element').html(scoutElementList[i].value);
                             $('#foundit-name').html(scoutElementList[i].value);
                             break;
                             }
                             }
                             });
        
        $("#rs-pop-up").live( "pagehide", function(event){
                             var parsedGameData = JSON.parse(localStorage.getItem("scout"));
                             var scoutElementList =parsedGameData.scavenge.items;
                             var currentScoutId = localStorage.getItem("currentScoutId");
                             
                             if(currentScoutId == null || currentScoutId == "null")
                             currentScoutId = "1";
                             
                             currentScoutId = Number(currentScoutId) - 1;
                             for (var i = 0; i < scoutElementList.length; i++) 
                             {
                             if( currentScoutId == scoutElementList.length)
                             {
                             var winner = whoWon();
                             if( winner != null)
                             {
                             //$('#winner-name-txt').html(winner.name);
                             $('#color-winner').toggleClass(winner.icon);
                             $.mobile.changePage( $("#the-end") );
                             break;
                             }
                             else
                             {
                             // when no one wins what do I do?
                             //$('#winner-name-txt').html("Everyone!!");
                             $.mobile.changePage( $("#the-end") );
                             break;
                             }
                             }
                             
                             if( currentScoutId == scoutElementList[i].id)
                             {
                             //set the next id for the next item to find.
                             $('#fun-fact').html(scoutElementList[i].fact);
                             break;
                             }
                             }
                             }); 
        
        $("#categories-game").live( "pagehide", function(event){
                                   var parsedGameData = JSON.parse(localStorage.getItem("cat"));
                                   var catElementList =parsedGameData.categories.items;
                                   var currentCatId = localStorage.getItem("currentCatId");
                                   
                                   if(currentCatId == null || currentCatId == "null")
                                   currentCatId = "1";
                                   
                                   for (var i = 0; i < catElementList.length; i++) 
                                   {
                                   if( currentCatId == catElementList[i].id)
                                   {
                                   //set the next id for the next item to find.
                                   var nextItem = catElementList[i].id;
                                   nextItem = Number(nextItem) +1;
                                   localStorage.setItem("currentCatId", nextItem);
                                   $('#categories-game-txt').html(catElementList[i].value);
                                   break;
                                   }
                                   }
                                   });
        
        $("#categories-messed-up").live( "pagehide", function(event){
                                        var parsedGameData = JSON.parse(localStorage.getItem("cat"));
                                        var catElementList =parsedGameData.categories.items;
                                        var currentCatId = localStorage.getItem("currentCatId");
                                        
                                        if(currentCatId == null || currentCatId == "null")
                                        currentCatId = "1";
                                        
                                        currentCatId = Number(currentCatId) - 1;
                                        for (var i = 0; i < catElementList.length; i++) 
                                        {
                                        if( currentCatId == catElementList.length)
                                        {
                                        var winner = whoWon();
                                        if( winner != null)
                                        {
                                        //$('#winner-name-txt').html(winner.name);
                                        $('#color-winner').toggleClass(winner.icon);
                                        $.mobile.changePage( $("#the-end") );
                                        break;
                                        }
                                        else
                                        {
                                        // when no one wins what do I do?
                                        //$('#winner-name-txt').html("Everyone!!");
                                        $.mobile.changePage( $("#the-end") );
                                        break;
                                        }
                                        }
                                        
                                        if( currentCatId == catElementList[i].id)
                                        {                
                                        $('#categories-messed-up-txt').html(catElementList[i].value);
                                        break;
                                        }
                                        }
                                        
                                        });
        $("#act-the-part").live( "pagehide", function(event){
                                var parsedGameData = JSON.parse(localStorage.getItem("act"));
                                var actElementList =parsedGameData.act.items;
                                var currentActId = localStorage.getItem("currentActId");
                                
                                if(currentActId == null || currentActId == "null")
                                currentActId = "1";
                                
                                for (var i = 0; i < actElementList.length; i++) 
                                {
                                if( currentActId == actElementList[i].id)
                                {                
                                //set the next id for the next item to find.
                                var nextItem = actElementList[i].id;
                                nextItem = Number(nextItem) +1;
                                localStorage.setItem("currentActId", nextItem);
                                $('#act-the-part-txt').html(actElementList[i].value);
                                break;
                                }
                                }
                                });
        $("#guessed-it").live( "pagehide", function(event){
                              var parsedGameData = JSON.parse(localStorage.getItem("act"));
                              var actElementList =parsedGameData.act.items;
                              var currentActId = localStorage.getItem("currentActId");
                              
                              if(currentActId == null || currentActId == "null")
                              currentActId = "1";
                              
                              currentActId = Number(currentActId) - 1;
                              for (var i = 0; i < actElementList.length; i++) 
                              {
                              if( currentActId == actElementList.length)
                              {
                              var winner = whoWon();
                              if( winner != null)
                              {
                              //$('#winner-name-txt').html(winner.name);
                              $('#color-winner').toggleClass(winner.icon);
                              $.mobile.changePage( $("#the-end") );
                              break;
                              }
                              else
                              {
                              // when no one wins what do I do?
                              //$('#winner-name-txt').html("Everyone!!");
                              $.mobile.changePage( $("#the-end") );
                              break;
                              }
                              }
                              if( currentActId == actElementList[i].id)
                              {                 
                              //set the next id for the next item to find.
                              $('#guessed-it-txt').html(actElementList[i].value);
                              break;
                              }
                              }
                              });
        </script>                
</html>